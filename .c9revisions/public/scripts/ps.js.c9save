{"ts":1368896775699,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var annee_courante = 2013;\nvar oPays1 = {\n    population: {\n        total : 65000,\n        pct_homme : 48/100,\n        tn : 12.6\n    },\n    groupes : []\n};\n\n//repartition de départ\nvar nb_homme = oPays1.population.pct_homme * oPays1.population.total;\nvar tabAllFemmes = [];\nvar tabAllHommes = [];\nfor (var i=0; i < oPays1.population.total; i++) {    \n    if (i < nb_homme) {\n        oPays1.groupes[i] = {\n            genre : \"homme\"\n        };\n        tabAllHommes.push(i);\n    }\n    else {\n        oPays1.groupes[i] = {\n            genre : \"femme\"\n        };\n        tabAllFemmes.push(i);\n    }\n}\nvar repartirAge = function (tabPop) {\n    var nbPop = tabPop.length; \n    var pct = parseInt((nbPop / 100), 10);\n    for (var i=0; i < 100; i++) {\n        var cohorte = i * pct;\n        var cohorteSuivante = (i + 1) * pct;\n        for (var id in tabPop) {\n            if (id >= cohorte && id < cohorteSuivante) {\n                oPays1.groupes[tabPop[id]].age = i;\n            }\n        }\n    }\n};\nrepartirAge(tabAllFemmes);\nrepartirAge(tabAllHommes);\n\n//lancement du temps.\nvar passerAnnee = function () {\n    annee_courante++;\n    for (var groupe in oPays1.groupes) {\n        oPays1.groupes[groupe].age++;\n    }\n    var nb_naissance = parseInt(oPays1.population.total * oPays1.population.tn/1000, 10);\n    oPays1.population.total = oPays1.population.total + nb_naissance;\n    for (var i=0; i < nb_naissance; i++) {\n        oPays1.groupes.push({genre:\"femme\", age:0});\n    }\n    $(\"#flux\").empty().append(\"Année courante : \" + annee_courante + \"<br />\" +\n        \"Population totale : \" + lisibilite_nombre(oPays1.population.total * 1000) + \" hab\" + \"<br />\" +\n        \"Nb de naissances en \" + (annee_courante - 1) + \" : \" + lisibilite_nombre(nb_naissance * 1000) + \"<br />\" +\n        \"Nombre de cohortes réelles : \" + lisibilite_nombre(oPays1.groupes.length) + \"<br />\" +\n        \"Deux exemples de cohortes : \" +\n        \"<ul>\" +\n        \"   <li>N°5212 - genre : \" + oPays1.groupes[5212].genre + \" / age : \" + oPays1.groupes[5212].age + \"</li>\" +\n        \"   <li>N°49 525 - genre : \" + oPays1.groupes[49525].genre + \" / age : \" + oPays1.groupes[49525].age + \"</li>\" +\n        \"</ul>\"\n    );\n    //alert(oPays1.population.total);\n};\n$(document).ready(function () {\n    var tabPaysJouables = [\"fr\", \"es\", \"uk\", \"de\"];\n    for (var idPays in tabPaysJouables) {\n        $(\"#svg2 #\" + tabPaysJouables[idPays]).css({\"fill\" : \"green\"});\n    }\n    \n    \n    $(\"body\").append('<div id=\"donnee_fixe\">Taux de natalité : <span id=\"tn\">12.6</span> enfants/an pour 1000 habs<input id=\"aug_alloc\" type=\"button\" value=\"augmenter les allocations familiales\" /></div><div id=\"flux\">Démarrage en cours...</div>');\n    setInterval(function () {passerAnnee()}, 12000);\n    $(\"#aug_alloc\").click(function () {\n        oPays1.population.tn = Math.round((oPays1.population.tn + 0.1)*10)/10;\n        $(\"#tn\").empty().append(oPays1.population.tn);\n    });\n    \n    \n});\n\nfunction lisibilite_nombre(nbr)\n{\n    var nombre = '' + nbr;\n    var retour = '';\n    var count=0;\n    for(var i=nombre.length-1 ; i>=0 ; i--)\n    {\n        if(count!==0 && count % 3 === 0)\n            retour = nombre[i]+' '+retour ;\n        else\n            retour = nombre[i]+retour ;\n        count++;\n    }\n    return retour;\n}\n\n\n\n\n\n// alert(\"Groupe : 4799\\n\" + \n//  \"genre : \" + oPays1.groupes[4799].genre + \"\\n\" +\n//  \"age : \" + oPays1.groupes[4799].age);\n// alert(\"Groupe 5000\\n\" + \n//  \"genre : \" + oPays1.groupes[5000].genre + \"\\n\" +\n//  \"age : \" + oPays1.groupes[5000].age);\n"]],"start1":0,"start2":0,"length1":0,"length2":3528}]],"length":3528}
{"contributors":[],"silentsave":false,"ts":1368896915947,"patch":[[{"diffs":[[0," \"green\""],[1,", \"cursor\" : \"pointer\""],[0,"});\n    "]],"start1":2417,"start2":2417,"length1":16,"length2":38}]],"length":3550,"saved":false}
{"ts":1368896981752,"patch":[[{"diffs":[[0,"pointer\"});\n"],[1,"        $(\"#svg2 #\" + tabPaysJouables[idPays]).mouseover(function () {\n            $(\"#svg2 #\" + tabPaysJouables[idPays]).css({\"fill\" : \"blue\"});\n        });\n"],[0,"    }\n    \n "]],"start1":2439,"start2":2439,"length1":24,"length2":182}]],"length":3708,"saved":false}
{"ts":1368897089328,"patch":[[{"diffs":[[0,"ter\"});\n        "],[1,"\n    }\n    "],[0,"$(\"#svg2 #\" + ta"]],"start1":2443,"start2":2443,"length1":32,"length2":43},{"diffs":[[0,"    });\n    "],[-1,"}"],[0,"\n    \n    \n "]],"start1":2612,"start2":2612,"length1":25,"length2":24}]],"length":3718,"saved":false}
{"ts":1368897095285,"patch":[[{"diffs":[[0,") {\n        "],[-1,"    "],[0,"$(\"#svg2 #\" "]],"start1":2529,"start2":2529,"length1":28,"length2":24},{"diffs":[[0,": \"blue\"});\n"],[-1,"    "],[0,"    });\n    "]],"start1":2592,"start2":2592,"length1":28,"length2":24}]],"length":3710,"saved":false}
{"ts":1368897102370,"patch":[[{"diffs":[[0,"  $("],[-1,"\"#svg2 #\" + tabPaysJouables[idPays]"],[1,"this"],[0,").cs"]],"start1":2539,"start2":2539,"length1":43,"length2":12}]],"length":3679,"saved":false}
{"ts":1368897136620,"patch":[[{"diffs":[[0,"});\n        "],[1,"$(\"#svg2 #\" + tabPaysJouables[idPays]).addClass(\"paysJouable\");"],[0,"\n    }\n    $"]],"start1":2447,"start2":2447,"length1":24,"length2":87}]],"length":3742,"saved":false}
{"ts":1368897149901,"patch":[[{"diffs":[[0,"   }\n    $(\""],[-1,"#svg2 #\" + tabP"],[1,".p"],[0,"aysJouables["]],"start1":2524,"start2":2524,"length1":39,"length2":26},{"diffs":[[0,"sJouable"],[-1,"s[idPays]"],[1,"\""],[0,").mouseo"]],"start1":2540,"start2":2540,"length1":25,"length2":17}]],"length":3721,"saved":false}
{"ts":1368897281470,"patch":[[{"diffs":[[0,"idPays])"],[1,"\n        "],[0,".css({\"f"]],"start1":2395,"start2":2395,"length1":16,"length2":25},{"diffs":[[0,"inter\"})"],[-1,";"],[0,"\n       "]],"start1":2450,"start2":2450,"length1":17,"length2":16},{"diffs":[[0,"    "],[-1,"$(\"#svg2 #\" + tabPaysJouables[idPays])"],[0,".add"]],"start1":2463,"start2":2463,"length1":46,"length2":8}]],"length":3691,"saved":false}
{"ts":1368897326667,"patch":[[{"diffs":[[0,"  .a"],[-1,"ddC"],[1,"ttr(\"c"],[0,"lass"],[-1,"("],[1,"\", "],[0,"\"pay"]],"start1":2465,"start2":2465,"length1":16,"length2":21}]],"length":3696,"saved":false}
{"ts":1368897513368,"patch":[[{"diffs":[[0,"lue\"});\n    });\n"],[1,"    $(\".paysJouable\").mouseout(function () {\n        $(this).css({\"fill\" : \"blue\"});\n    });\n"],[0,"    \n    \n    \n "]],"start1":2582,"start2":2582,"length1":32,"length2":125}]],"length":3789,"saved":false}
{"ts":1368897518796,"patch":[[{"diffs":[[0,".css({\"fill\" : \""],[-1,"blue"],[1,"green"],[0,"\"});\n    });\n   "]],"start1":2658,"start2":2658,"length1":36,"length2":37}]],"length":3790,"saved":false}
{"contributors":[],"silentsave":false,"ts":1368906282389,"patch":[[{"diffs":[[0,"ur;\n}\n\n\n"],[1,"var socket = io.connect('http://localhost');\nsocket.on('news', function (data) {\nconsole.log(data);\nsocket.emit('my other event', { my: 'data' });\n});"],[0,"\n\n\n// al"]],"start1":3531,"start2":3531,"length1":16,"length2":166}]],"length":3940,"saved":false}
{"ts":1368906823788,"patch":[[{"diffs":[[0,"ect("],[-1,"'http://localhost'"],[1,"window.location.origin"],[0,");\ns"]],"start1":3559,"start2":3559,"length1":26,"length2":30}]],"length":3944,"saved":false}
{"ts":1368907550612,"patch":[[{"diffs":[[0,"our;\n}\n\n"],[1,"alert(io);"],[0,"\nvar soc"]],"start1":3530,"start2":3530,"length1":16,"length2":26}]],"length":3954,"saved":false}
{"ts":1368907562943,"patch":[[{"diffs":[[0,"\n}\n\n"],[-1,"alert(io);\n"],[0,"var "]],"start1":3534,"start2":3534,"length1":19,"length2":8}]],"length":3943,"saved":false}
{"ts":1368907568740,"patch":[[{"diffs":[[0,"data) {\n"],[1,"    "],[0,"console."]],"start1":3615,"start2":3615,"length1":16,"length2":20},{"diffs":[[0,"(data);\n"],[1,"    "],[0,"socket.e"]],"start1":3638,"start2":3638,"length1":16,"length2":20}]],"length":3951,"saved":false}
{"ts":1368907711887,"patch":[[{"diffs":[[0,"on (data) {\n"],[1,"    alert(\"news\");\n"],[0,"    console."]],"start1":3611,"start2":3611,"length1":24,"length2":43}]],"length":3970,"saved":false}
{"ts":1368907756393,"patch":[[{"diffs":[[0,") {\n"],[-1,"    alert(\"news\");\n"],[0,"    "]],"start1":3619,"start2":3619,"length1":27,"length2":8}]],"length":3951,"saved":false}
{"ts":1368909349511,"patch":[[{"diffs":[[0,"tour;\n}\n"],[1,"function init () {"],[0,"\n"],[-1,""],[0,"var sock"]],"start1":3529,"start2":3529,"length1":17,"length2":35},{"diffs":[[0,"rigin);\n"],[1,"    "],[0,"socket.o"]],"start1":3597,"start2":3597,"length1":16,"length2":20},{"diffs":[[0,"on (data) {\n"],[1,"    "],[0,"    console."]],"start1":3633,"start2":3633,"length1":24,"length2":28},{"diffs":[[0,"(data);\n    "],[1," "],[1,"   "],[0,"socket.emit("]],"start1":3664,"start2":3664,"length1":24,"length2":28},{"diffs":[[0,"ta' });\n"],[1,"    "],[0,"});\n"],[-1,"\n"],[1,"}"],[0,"\n// aler"]],"start1":3719,"start2":3719,"length1":21,"length2":25}]],"length":3985,"saved":false}
{"ts":1368909429075,"patch":[[{"diffs":[[0,"on('"],[-1,"news"],[1,"connect"],[0,"', f"]],"start1":3616,"start2":3616,"length1":12,"length2":15}]],"length":3988,"saved":false}
{"ts":1368909440747,"patch":[[{"diffs":[[0,"ket.on('"],[-1,"connect"],[1,"news"],[0,"', funct"]],"start1":3612,"start2":3612,"length1":23,"length2":20}]],"length":3985,"saved":false}
{"ts":1368909460605,"patch":[[{"diffs":[[0,"    });\n    "],[1,"init();"],[0,"\n    \n});\n\nf"]],"start1":3183,"start2":3183,"length1":24,"length2":31},{"diffs":[[0,"it () {\n"],[1,"    "],[0,"var sock"]],"start1":3555,"start2":3555,"length1":16,"length2":20}]],"length":3996,"saved":false}
{"ts":1368909503289,"patch":[[{"diffs":[[0,"on.origin);\n"],[1,"    socket.on('connect', function () {\n        \n    }\n"],[0,"    socket.o"]],"start1":3604,"start2":3604,"length1":24,"length2":78}]],"length":4050,"saved":false}
{"ts":1368909514551,"patch":[[{"diffs":[[0,") {\n        "],[1,"console.log(\"connecté !\");"],[0,"\n    }\n    s"]],"start1":3651,"start2":3651,"length1":24,"length2":50}]],"length":4076,"saved":false}
{"ts":1368909517416,"patch":[[{"diffs":[[0,"é !\");\n    }"],[1,");"],[0,"\n    socket."]],"start1":3683,"start2":3683,"length1":24,"length2":26}]],"length":4078,"saved":false}
{"ts":1368909945512,"patch":[[{"diffs":[[0,"on('"],[-1,"c"],[1,"d"],[0,"onne"],[-1,"ct', function () {\n        console.log(\"connecté !\");\n    });\n    socket.on('news"],[1,"es_serveur"],[0,"', f"]],"start1":3627,"start2":3627,"length1":94,"length2":23}]],"length":4007,"saved":false}
{"ts":1368909958794,"patch":[[{"diffs":[[0,"log(data"],[1,".annee_courante"],[0,");\n     "]],"start1":3683,"start2":3683,"length1":16,"length2":31}]],"length":4022,"saved":false}
{"ts":1368909961759,"patch":[[{"diffs":[[0,"e);\n        "],[1,"//"],[0,"socket.emit("]],"start1":3705,"start2":3705,"length1":24,"length2":26}]],"length":4024,"saved":false}
{"ts":1368910924135,"patch":[[{"diffs":[[0,"on (data) {\n"],[1,"        $(\"#annee_courante\").empty().text(data.annee_courante)\n"],[0,"        cons"]],"start1":3655,"start2":3655,"length1":24,"length2":87}]],"length":4087,"saved":false}
{"ts":1368910926836,"patch":[[{"diffs":[[0,"ourante)"],[1,";"],[0,"\n       "]],"start1":3721,"start2":3721,"length1":16,"length2":17}]],"length":4088,"saved":false}
{"ts":1368910946425,"patch":[[{"diffs":[[0,"   $(\"#annee"],[-1,"_"],[1,"-"],[0,"courante\").e"]],"start1":3672,"start2":3672,"length1":25,"length2":25}]],"length":4088,"saved":false}
{"ts":1368911026465,"patch":[[{"diffs":[[0,"    "],[-1,"    //socket.emit('my other event', { my: 'data' });"],[1,"});\n    $(\"#button-restart\").click(function () {\n        "],[0,"\n   "]],"start1":3773,"start2":3773,"length1":60,"length2":65}]],"length":4093,"saved":false}
{"ts":1368911129760,"patch":[[{"diffs":[[0,") {\n        "],[1,"socket.emit('relancer');"],[0,"\n    });\n}\n/"]],"start1":3822,"start2":3822,"length1":24,"length2":48}]],"length":4117,"saved":false}
